# Node.js REST API Tech Stack
# Express.js backend with TypeScript

name: nodejs-api
display_name: "Node.js REST API"
description: "RESTful API with Express.js and TypeScript"
category: backend

# Project structure
src_dir: src
test_dir: src/__tests__

# Commands
install_command: npm install
test_command: npm test
build_command: npm run build
start_command: npm start

# File patterns
source_pattern: "**/*.ts"
test_pattern: "**/*.test.ts"

# Conventions for LLM code generation
conventions: |
  Project Structure:
  - Entry point: src/index.ts (Express app setup)
  - Routes: src/routes/{name}.ts (one file per resource)
  - Route index: src/routes/index.ts (registers all routes)
  - Handlers: Export handler functions, not classes
  - Tests: src/__tests__/{name}.test.ts (colocated with source)

  Code Style:
  - Use async/await for all async operations
  - Use Zod for request validation
  - Return proper HTTP status codes (201 for create, 200 for success, 400 for validation, 404 for not found)
  - Use descriptive variable names, avoid abbreviations
  - Export types from the file that defines them

  Testing:
  - Use supertest for HTTP testing
  - Test file naming: {feature}.test.ts
  - Describe blocks for each endpoint
  - Test both success and error cases

  Express Patterns:
  - Use Router() for modular routes
  - Middleware signature: (req, res, next) => {}
  - Error handling: pass errors to next(error)
  - JSON responses: res.json({ ... })

# Initial project files (for scaffolding only)
config_files:
  package.json: |
    {
      "name": "{{project_name}}",
      "version": "1.0.0",
      "main": "dist/index.js",
      "scripts": {
        "dev": "ts-node-dev --respawn src/index.ts",
        "build": "tsc",
        "start": "node dist/index.js",
        "test": "jest"
      },
      "dependencies": {
        "express": "^4.18.2",
        "zod": "^3.22.4"
      },
      "devDependencies": {
        "typescript": "^5.3.3",
        "ts-node-dev": "^2.0.0",
        "jest": "^29.7.0",
        "ts-jest": "^29.1.1",
        "@types/jest": "^29.5.11",
        "@types/node": "^20.10.6",
        "@types/express": "^4.17.21",
        "supertest": "^6.3.3",
        "@types/supertest": "^6.0.2"
      }
    }

  tsconfig.json: |
    {
      "compilerOptions": {
        "target": "ES2022",
        "module": "commonjs",
        "outDir": "./dist",
        "rootDir": "./src",
        "strict": true,
        "esModuleInterop": true,
        "skipLibCheck": true,
        "resolveJsonModule": true
      },
      "include": ["src/**/*"],
      "exclude": ["node_modules", "dist"]
    }

  jest.config.js: |
    module.exports = {
      preset: 'ts-jest',
      testEnvironment: 'node',
      roots: ['<rootDir>/src'],
      testMatch: ['**/__tests__/**/*.test.ts'],
    };

# Runner configuration
runner_image: node:20-slim
